subject_set{1} = {...
'/Users/david/Box Sync/behavioral/data/S202/S2027375394740137274.mat',...
'/Users/david/Box Sync/behavioral/data/S202/S2027375394789492066.mat',...
'/Users/david/Box Sync/behavioral/data/S202/S2027375394844529881.mat',...
'/Users/david/Box Sync/behavioral/data/S202/S2027375394903016632.mat',...
'/Users/david/Box Sync/behavioral/data/S202/S202b7375394970314943.mat',...
'/Users/david/Box Sync/behavioral/data/S202/S202b7375395023405956.mat',...
};

subject_set{2} = {...
'/Users/david/Box Sync/behavioral/data/S203/S2037375397649721921.mat',...
'/Users/david/Box Sync/behavioral/data/S203/S2037375397696607697.mat',...
'/Users/david/Box Sync/behavioral/data/S203/S2037375397743570504.mat',...
'/Users/david/Box Sync/behavioral/data/S203/S2037375397789895178.mat',...
'/Users/david/Box Sync/behavioral/data/S203/S203b7375397880103999.mat',...
'/Users/david/Box Sync/behavioral/data/S203/S203b7375397925909075.mat',...
};

subject_set{3} = {...
'/Users/david/Box Sync/behavioral/data/S204/S2047375398056795938.mat',...
'/Users/david/Box Sync/behavioral/data/S204/S2047375398104495467.mat',...
'/Users/david/Box Sync/behavioral/data/S204/S2047375398156861580.mat',...
'/Users/david/Box Sync/behavioral/data/S204/S2047375398208706863.mat',...
'/Users/david/Box Sync/behavioral/data/S204/S204b7375398318863456.mat',...
'/Users/david/Box Sync/behavioral/data/S204/S204b7375398365061877.mat',...
};

subject_set{4} = {...
'/Users/david/Box Sync/behavioral/data/S205/S2057375407688388792.mat',...
'/Users/david/Box Sync/behavioral/data/S205/S2057375407736943652.mat',...
'/Users/david/Box Sync/behavioral/data/S205/S2057375407783926887.mat',...
'/Users/david/Box Sync/behavioral/data/S205/S2057375407830556957.mat',...
'/Users/david/Box Sync/behavioral/data/S205/S205b7375407918941979.mat',...
'/Users/david/Box Sync/behavioral/data/S205/S205b7375407965141134.mat',...
};

subject_set{5} = {...
'/Users/david/Box Sync/behavioral/data/S206/S2067375448077689847.mat',...
'/Users/david/Box Sync/behavioral/data/S206/S2067375448125526436.mat',...
'/Users/david/Box Sync/behavioral/data/S206/S2067375448174458995.mat',...
'/Users/david/Box Sync/behavioral/data/S206/S2067375448222600633.mat',...
'/Users/david/Box Sync/behavioral/data/S206/S206b7375448335349238.mat',...
'/Users/david/Box Sync/behavioral/data/S206/S206b7375448382458219.mat',...
};

subject_set{6} = {...
'/Users/david/Box Sync/behavioral/data/S207/S2077375448480627884.mat',...
'/Users/david/Box Sync/behavioral/data/S207/S2077375448526764995.mat',...
'/Users/david/Box Sync/behavioral/data/S207/S2077375448576287654.mat',...
'/Users/david/Box Sync/behavioral/data/S207/S2077375448624028321.mat',...
'/Users/david/Box Sync/behavioral/data/S207/S207b7375448696618656.mat',...
'/Users/david/Box Sync/behavioral/data/S207/S207b7375448742888221.mat',...
};

subject_set{7} = {...
'/Users/david/Box Sync/behavioral/data/S208/S2087375454713426187.mat',...
'/Users/david/Box Sync/behavioral/data/S208/S2087375454764923796.mat',...
'/Users/david/Box Sync/behavioral/data/S208/S2087375454815653098.mat',...
'/Users/david/Box Sync/behavioral/data/S208/S2087375454865948932.mat',...
'/Users/david/Box Sync/behavioral/data/S208/S208b7375454971757990.mat',...
'/Users/david/Box Sync/behavioral/data/S208/S208b7375455020906423.mat',...
};

subject_set{8} = {...
'/Users/david/Box Sync/behavioral/data/S209/S2097375463489095919.mat',...
'/Users/david/Box Sync/behavioral/data/S209/S2097375463538408497.mat',...
'/Users/david/Box Sync/behavioral/data/S209/S2097375463588051014.mat',...
'/Users/david/Box Sync/behavioral/data/S209/S2097375463636925988.mat',...
'/Users/david/Box Sync/behavioral/data/S209/S209b7375463738806302.mat',...
'/Users/david/Box Sync/behavioral/data/S209/S209b7375463787928371.mat',...
};

subject_set{9} = {...
'/Users/david/Box Sync/behavioral/data/S210/S2107375463889405618.mat',...
'/Users/david/Box Sync/behavioral/data/S210/S2107375463945039024.mat',...
'/Users/david/Box Sync/behavioral/data/S210/S2107375463996085866.mat',...
'/Users/david/Box Sync/behavioral/data/S210/S2107375464049228992.mat',...
'/Users/david/Box Sync/behavioral/data/S210/S210b7375464137087413.mat',...
'/Users/david/Box Sync/behavioral/data/S210/S210b7375464187386362.mat',...
};

subject_set{10} = {...
'/Users/david/Box Sync/behavioral/data/S211/S2117375464289085608.mat',...
'/Users/david/Box Sync/behavioral/data/S211/S2117375464335306193.mat',...
'/Users/david/Box Sync/behavioral/data/S211/S2117375464381991579.mat',...
'/Users/david/Box Sync/behavioral/data/S211/S2117375464428161229.mat',...
'/Users/david/Box Sync/behavioral/data/S211/S211b7375464527783787.mat',...
'/Users/david/Box Sync/behavioral/data/S211/S211b7375464573247534.mat',...
};

subject_set{11} = {...
'/Users/david/Box Sync/behavioral/data/S212/S2127375464724718205.mat',...
'/Users/david/Box Sync/behavioral/data/S212/S2127375464771795252.mat',...
'/Users/david/Box Sync/behavioral/data/S212/S2127375464819061449.mat',...
'/Users/david/Box Sync/behavioral/data/S212/S2127375464866051227.mat',...
'/Users/david/Box Sync/behavioral/data/S212/S212b7375464953104665.mat',...
'/Users/david/Box Sync/behavioral/data/S212/S212b7375464999894875.mat',...
};

subject_set{12} = {...
'/Users/david/Box Sync/behavioral/data/S213/S2137375465099561478.mat',...
'/Users/david/Box Sync/behavioral/data/S213/S2137375465149012688.mat',...
'/Users/david/Box Sync/behavioral/data/S213/S2137375465198437258.mat',...
'/Users/david/Box Sync/behavioral/data/S213/S2137375465248372877.mat',...
'/Users/david/Box Sync/behavioral/data/S213/S213b7375465336323021.mat',...
'/Users/david/Box Sync/behavioral/data/S213/S213b7375465384716943.mat',...
};

subject_set{13} = {...
'/Users/david/Box Sync/behavioral/data/S214/S2147375465569140232.mat',...
'/Users/david/Box Sync/behavioral/data/S214/S2147375465616087765.mat',...
'/Users/david/Box Sync/behavioral/data/S214/S2147375465663095113.mat',...
'/Users/david/Box Sync/behavioral/data/S214/S2147375465709766699.mat',...
'/Users/david/Box Sync/behavioral/data/S214/S214b7375465798726357.mat',...
'/Users/david/Box Sync/behavioral/data/S214/S214b7375465845723377.mat',...
};

subject_set{14} = {...
'/Users/david/Box Sync/behavioral/data/S215/S2157375465946799803.mat',...
'/Users/david/Box Sync/behavioral/data/S215/S2157375465993886502.mat',...
'/Users/david/Box Sync/behavioral/data/S215/S2157375466041312324.mat',...
'/Users/david/Box Sync/behavioral/data/S215/S2157375466090422351.mat',...
'/Users/david/Box Sync/behavioral/data/S215/S215b7375466179745784.mat',...
'/Users/david/Box Sync/behavioral/data/S215/S215b7375466226982151.mat',...
};

subject_set{15} = {...
'/Users/david/Box Sync/behavioral/data/S223/S2237375487128202238.mat',...
'/Users/david/Box Sync/behavioral/data/S223/S2237375487176198723.mat',...
'/Users/david/Box Sync/behavioral/data/S223/S2237375487224496761.mat',...
'/Users/david/Box Sync/behavioral/data/S223/S2237375487271392049.mat',...
'/Users/david/Box Sync/behavioral/data/S223/S223b7375487360495691.mat',...
'/Users/david/Box Sync/behavioral/data/S223/S223b7375487406854678.mat',...
};

subject_set{16} = {...
'/Users/david/Box Sync/behavioral/data/S224/S2247375487608497796.mat',...
'/Users/david/Box Sync/behavioral/data/S224/S2247375487657124167.mat',...
'/Users/david/Box Sync/behavioral/data/S224/S2247375487707077039.mat',...
'/Users/david/Box Sync/behavioral/data/S224/S2247375487755697271.mat',...
'/Users/david/Box Sync/behavioral/data/S224/S224b7375487855856762.mat',...
'/Users/david/Box Sync/behavioral/data/S224/S224b7375487902100297.mat',...
};

subject_set{17} = {...
'/Users/david/Box Sync/behavioral/data/S225/S2257375488428016176.mat',...
'/Users/david/Box Sync/behavioral/data/S225/S2257375488477465204.mat',...
'/Users/david/Box Sync/behavioral/data/S225/S2257375488525234619.mat',...
'/Users/david/Box Sync/behavioral/data/S225/S2257375488573622955.mat',...
'/Users/david/Box Sync/behavioral/data/S225/S225b7375488662637561.mat',...
'/Users/david/Box Sync/behavioral/data/S225/S225b7375488710377734.mat',...
};

subject_set{18} = {...
'/Users/david/Box Sync/behavioral/data/S226/S2267375488879095681.mat',...
'/Users/david/Box Sync/behavioral/data/S226/S2267375488927542289.mat',...
'/Users/david/Box Sync/behavioral/data/S226/S2267375488975294135.mat',...
'/Users/david/Box Sync/behavioral/data/S226/S2267375489029469683.mat',...
'/Users/david/Box Sync/behavioral/data/S226/S226b7375489122193741.mat',...
'/Users/david/Box Sync/behavioral/data/S226/S226b7375489173159001.mat',...
};

subject_set{19} = {...
'/Users/david/Box Sync/behavioral/data/S227/S2277375495120762823.mat',...
'/Users/david/Box Sync/behavioral/data/S227/S2277375495170953877.mat',...
'/Users/david/Box Sync/behavioral/data/S227/S2277375495219259626.mat',...
'/Users/david/Box Sync/behavioral/data/S227/S2277375495266904338.mat',...
'/Users/david/Box Sync/behavioral/data/S227/S227b7375495368924679.mat',...
'/Users/david/Box Sync/behavioral/data/S227/S227b7375495418588594.mat',...
};

subject_set{20} = {...
'/Users/david/Box Sync/behavioral/data/S229/S2297376886380321950.mat',...
'/Users/david/Box Sync/behavioral/data/S229/S2297376886430240427.mat',...
'/Users/david/Box Sync/behavioral/data/S229/S2297376886483146588.mat',...
'/Users/david/Box Sync/behavioral/data/S229/S2297376886535713514.mat',...
'/Users/david/Box Sync/behavioral/data/S229/S229b7376886612393155.mat',...
'/Users/david/Box Sync/behavioral/data/S229/S229b7376886660194317.mat',...
};

subject_set{21} = {...
'/Users/david/Box Sync/behavioral/data/S230/S2307376886784636630.mat',...
'/Users/david/Box Sync/behavioral/data/S230/S2307376886832228197.mat',...
'/Users/david/Box Sync/behavioral/data/S230/S2307376886879918516.mat',...
'/Users/david/Box Sync/behavioral/data/S230/S2307376886928032916.mat',...
'/Users/david/Box Sync/behavioral/data/S230/S230b7376886998570854.mat',...
'/Users/david/Box Sync/behavioral/data/S230/S230b7376887049597031.mat',...
};

subject_set{22} = {...
'/Users/david/Box Sync/behavioral/data/S236/S2367377237223871930.mat',...
'/Users/david/Box Sync/behavioral/data/S236/S2367377237272977278.mat',...
'/Users/david/Box Sync/behavioral/data/S236/S2367377237321033938.mat',...
'/Users/david/Box Sync/behavioral/data/S236/S2367377237368390623.mat',...
'/Users/david/Box Sync/behavioral/data/S236/S236b7377237457949199.mat',...
'/Users/david/Box Sync/behavioral/data/S236/S236b7377237504904873.mat',...
};

subject_set{23} = {...
'/Users/david/Box Sync/behavioral/data/S239/S2397377494310382804.mat',...
'/Users/david/Box Sync/behavioral/data/S239/S2397377494358906606.mat',...
'/Users/david/Box Sync/behavioral/data/S239/S2397377494406243634.mat',...
'/Users/david/Box Sync/behavioral/data/S239/S2397377494456732647.mat',...
'/Users/david/Box Sync/behavioral/data/S239/S239b7377494535301392.mat',...
'/Users/david/Box Sync/behavioral/data/S239/S239b7377494582983339.mat'...
};

subject_set{24} = {...
'/Users/david/Box Sync/behavioral/data/S240/S2407377626754317668.mat',...
'/Users/david/Box Sync/behavioral/data/S240/S2407377626802324236.mat',...
'/Users/david/Box Sync/behavioral/data/S240/S2407377626851094826.mat',...
'/Users/david/Box Sync/behavioral/data/S240/S2407377626899074776.mat',...
'/Users/david/Box Sync/behavioral/data/S240/S240b7377626971614870.mat',...
'/Users/david/Box Sync/behavioral/data/S240/S240b7377627018311312.mat'...
};


%% combine block data from each subject into a data set structure:
all_blocks = 1:6;
desired_output_blocks = 1:5;
blocks_to_combine = [5, 6];

data_sets = cell(1, length(subject_set));
for i_sub = 1:length(subject_set)
    sub_data_set = cell(1, length(desired_output_blocks));
    sub_blocks = 1:length(subject_set{i_sub});
    
    sub_indiv_blocks = intersect(...
        setdiff(all_blocks, blocks_to_combine),...
        sub_blocks);
    sub_combine_blocks = intersect(...
        blocks_to_combine,...
        sub_blocks);
    for i_block = 1:length(sub_indiv_blocks)
        load(subject_set{i_sub}{sub_indiv_blocks(i_block)});
        sub_data_set{i_block} = Data;
    end
    param_comb = struct('trial_type', [], 'trial_home_numbers', [],...
            'trial_target_numbers', [], 'trial_stimA_numbers', [], 'prescribed_PT', []);
    Data_comb = struct(...
        'MT', [],...
        'RT', [],...
        'Succ', [],...
        'pPT', [],...
        'time_targ_disp', [],...
        'time_stimA_disp', [],...
        'Type', [],...
        'ViewTime', [],...
        'Kinematics', {},...
        'EventTimes', [], ...
        'Target', [],...
        'Home', [], ...
        'Score', []);
    for i_block = 1:length(sub_combine_blocks)
        load(subject_set{i_sub}{sub_combine_blocks(i_block)});
        Data_comb(1).MT = [Data_comb.MT; Data.MT];
        Data_comb(1).RT = [Data_comb.RT; Data.RT];
        Data_comb(1).Succ = [Data_comb.Succ; Data.Succ];
        Data_comb(1).pPT = [Data_comb.pPT; Data.pPT];
        Data_comb(1).time_targ_disp = [Data_comb.time_targ_disp; Data.time_targ_disp];
        Data_comb(1).time_stimA_disp = [Data_comb.time_stimA_disp; Data.time_stimA_disp];
        Data_comb(1).Type = [Data_comb.Type; Data.Type];
        Data_comb(1).ViewTime = [Data_comb.ViewTime; Data.ViewTime];
        Data_comb(1).Target = [Data_comb.Target; Data.Target];
        Data_comb(1).Home = [Data_comb.Home; Data.Home];
        Data_comb(1).Score = [Data_comb.Score; Data.Score];
        Data_comb(1).Kinematics = [Data_comb.Kinematics; Data.Kinematics];
        Data_comb(1).EventTimes = [Data_comb.EventTimes; Data.EventTimes];
        
        param_comb(1).trial_type = [param_comb.trial_type, Data.params.trial_type];
        param_comb(1).trial_home_numbers = [param_comb.trial_home_numbers, Data.params.trial_home_numbers];
        param_comb(1).trial_target_numbers = [param_comb.trial_target_numbers, Data.params.trial_target_numbers];
        param_comb(1).trial_stimA_numbers = [param_comb.trial_stimA_numbers, Data.params.trial_stimA_numbers];
        param_comb(1).prescribed_PT = [param_comb.prescribed_PT, Data.params.prescribed_PT];
    end
    Data_comb.params = param_comb;
    sub_data_set{desired_output_blocks(end)} = Data_comb;
    data_sets{i_sub} = sub_data_set;
end

% if ~exist('data_sets.mat', 'file')
    save data_sets_v4 data_sets
% end
%% plot each subject's trajectories for each block:
for i_sub = 10 %1:length(subject_set)
    figure;
    for i_block = 1:length(subject_set{i_sub})
        load(subject_set{i_sub}{i_block});
        subplot(2,3, i_block);
        [pd, err_] = process_block(Data);
        plot(pd.x, pd.y, '.-');
    end
    data_sets{i_sub} = sub_data_set;
end